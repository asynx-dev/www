language: python
jobs:
  include:
  - name: deploy_build
    install:
    - pip3 install -r requirements.txt
    script:
    - mkdocs build --clean --config-file mkdocs-deploy.yml
    - touch ./site/.nojekyll
    - cp CNAME ./site
    - date -Iseconds >> ./site/build.info.txt
    - mkdocs --version >> ./site/build.info.txt
    - git log -1 --oneline >> ./site/build.info.txt
    deploy:
      provider: pages
      local_dir: site
      skip_cleanup: true
      deployment_file: true
      verbose: true
      github_token: "$GITHUB_TOKEN"
  - name: merge_build
    install:
    - pip3 install -r requirements.txt
    script:
    - mkdocs build --clean --strict --verbose --config-file mkdocs-merge.yml
    - touch ./site/.nojekyll
    - cp CNAME ./site
    - date -Iseconds >> ./site/build.info.txt
    - chmod +x ./test/main-simple.sh
    - "./test/main-simple.sh"
notifications:
  slack:
    rooms:
      secure: PhFjXRhv3cxu4jOF3pow7XJ/VEsvdNy24Ewe7mpSy0+ooxggaKvlgBs5qNhqA+HJhBbLGYqrV5pg5UKci0zLlIdNMxibdiSsppNnn7AQ8jbz6Giz+7UQsHr9FywM50noMPoZ/2KxAT79aPaZsxtXYCdUDNne0wh0E2FX6ic5FRgobDblbW7nipH5SqL7Fc2bi8tBGhC66naIW/3vMlaMBJYqpWsKdhu5jB05rHkgFT7Md+kua8NYVi/JyvX6wK0Yr4prv5Tu5j3elB741mvZXdJjaXFttetVQqGArvz6W9Swh217fyljrtG2wVf8tX+RdPP7KqXPteO9mL24msSmkW5kQv6zCRC0Pa7gO9z2GLu3QRsMeSfaSAzJwxHPvg12YQRPnKjLxVXlVYnxEvb8oMbif6KWTITCy6X37NgVzVp1z7UPATYCTWGUn+Z6cEzm11ppn7WQGss5PcujwkY+fmAO5c/C8WXwDyi3KqxAxNGN2fQj3r//SK3lafeX7PgmDrFQW9GGiLVid78xFBsgprPsQJwdEPUePI9LYk6m99qfetZ0Bq0QLovyQyJrXPGyE4WpHT+YqjZfZq61HTW/tlSfjvythZa4kaz1CNLup/hvq+whqjOVWH0oe9vSRAnm+x3iDK6zmEBYl4oESUTrL+Tek3lceIDqUgst8mUD0AE=
